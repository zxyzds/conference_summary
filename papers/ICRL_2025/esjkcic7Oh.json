{
    "id": "esjkcic7Oh",
    "title": "AlignAb: Pareto-Optimal Energy Alignment for Designing Nature-Like Antibodies",
    "abstract": "We present a three-stage framework for training deep learning models specializing in antibody sequence-structure co-design.\nWe first pre-train a language model based on millions of antibody sequence data.\nThen, we employ the learned representations to guide the training of a diffusion model for joint optimization over both sequence and structure of antibodies. \nDuring the final alignment stage, we optimize the model to favor antibodies with low repulsion and high attraction to the antigen binding site, enhancing the rationality and functionality of the design.\nTo mitigate conflicting energy preferences, we extend AbDPO (Antibody Direct Preference Optimization) to guide the model towards Pareto optimality under multiple energy-based alignment objectives. \nFurthermore, we adopt an iterative learning paradigm with temperature scaling, enabling the model to benefit from diverse online datasets without requiring additional data.\nIn practice, our proposed methods achieve high stability and efficiency in producing a better Pareto front of antibody designs compared to top samples generated by baselines and previous alignment techniques.\nThrough extensive experiments, we showcase the superior performance of our methods in generating nature-like antibodies with high binding affinity consistently.",
    "keywords": [
        "Antibody Design",
        "Diffusion Models",
        "Multi-Objective Optimization"
    ],
    "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)",
    "TLDR": "",
    "creation_date": "2024-09-27",
    "original_date": "2024-10-04",
    "modification_date": "2024-10-13",
    "forum_link": "https://openreview.net/forum?id=esjkcic7Oh",
    "pdf_link": "https://openreview.net/pdf?id=esjkcic7Oh",
    "comments": [
        {
            "summary": {
                "value": "This paper presents AlignAb, a three-stage framework for designing nature-like antibodies using deep learning. It involves pre-training on antibody sequences, guiding a diffusion model for joint sequence-structure optimization, and aligning the model to favor antibodies with desired antigen interactions. The approach aims to address energy preference conflicts and leverages online data without extra resources, generating high-affinity antibodies."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 2
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "This paper focuses on in silico antibody design, which is a crucial aspect of developing effective therapeutics. To address the issue of generating antibodies with low affinity due to the neglect of energy functions in existing literature, a three-stage framework is proposed to tackle the antibody design challenge. This framework employs AbDPO to guide the model in generating samples with lower energy."
            },
            "weaknesses": {
                "value": "1. The authors place excessive emphasis on the performance of their proposed method in terms of energy metrics to demonstrate the ability to design higher-affinity antibodies. However, the energy calculations rely on Rosetta, and thus the computed energy does not accurately represent the binding affinity between the antibody and the antigen. The authors do not clarify whether this evaluation metric is practically useful.\n\n2. The model presented in this paper specifically optimizes for energy, making comparisons with other methods that do not focus on energy optimization somewhat unfair. Notably, the model utilizes known regions of antibodies and only designs the CDR3, effectively assuming that the binding will be consistent with the original antibody. In this context, metrics such as AAR and RMSD can reflect the positional and sequence differences relative to the original antibody.\n\n3. While this paper proposes a three-stage framework, each stage employs existing methods. For instance, the pre-training phase is based on ABGNN, the transferring phase draws from DiffAb, and the alignment phase utilizes AbDPO and Diffusion-DPO to enhance energy. Overall, there appears to be limited technical innovation in this approach."
            },
            "questions": {
                "value": "1. Did the authors perform OAS deduplication, and does OAS include samples from the test set?\n\n2. Regarding the RAbD benchmark, which contains 60 antibody-antigen complexes, the authors only utilized 42, which is even fewer than the 55 used by AbDPO. What is the reason for this discrepancy?\n\n3. Currently, there is no research demonstrating that Rosetta's energy values are effective for real-world antibody design. Did the authors test other energy prediction methods for performance evaluation, such as those used in dyMEAN?\n\n4. The authors did not compare their method with AbDPO, which is also mentioned in the article as focusing on energy optimization. Furthermore, the reported values for relevant metrics differ significantly from those reported for AbDPO, particularly for the MEA. Given that both methods use Rosetta, what accounts for this substantial difference?\n\n5. The article does not provide code for easy reproduction and understanding.\n\n6. In Figure 4, MEAN is also designed specifically for CDR3. Why does the framework structure of one of the chains differ from that of other methods? Additionally, what is the purpose of this figure? Does it indicate a high similarity to the original antibody?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 3
            },
            "confidence": {
                "value": 5
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper introduces a three-stage framework aimed at training deep learning models for the co-design of antibody sequences and structures. The primary contributions in this paper include the development of multi-objective alignment algorithm for generating a superior Pareto front of models in terms of energy without additional data. This model can generate more natural-like antibodies with better rationality and functionality."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 4
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "This paper is well-written and has a clear motivation. In addition, the methodology section is detailed and easy to follow. \nThe proposed framework can achieve state-of-the-art performance in generating more natural-like antibodies by aligning the model to favor configurations with low repulsion and high attraction energy at the binding site.\nIt presents a three-stage framework (pre-training, transferring, and alignment) in antibody sequence-structure co-design, that extends DPO to achieve Pareto optimality with multiple energy-based alignment objectives."
            },
            "weaknesses": {
                "value": "Given that the proposed method is an extension of AbDPO, it would be beneficial to include AbDPO as a benchmark for comparison.\nAlthough there are reasonable metrics used in this paper, it is recommended that the authors include RMSD and AAR in their evaluation metrics to provide a more comprehensive understanding of the generated antibodies' quality and to align with established benchmarks."
            },
            "questions": {
                "value": "This paper mentioned the use of a decaying temperature schedule, inspired by epsilon-greedy learning from RL, to balance exploration and exploitation. What are your thoughts on employing more advanced strategies instead, such as UCB?\nGiven that your work builds upon AbDPO, could you provide a more detailed comparison between this approach and AbDPO?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 6
            },
            "confidence": {
                "value": 5
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper presents a three-stage framework for training deep-learning models specializing in antibody sequence-structure co-design. We first pre-train a language model using millions of antibody sequence data. Experiments demonstrate the advantages of the proposed framework in\ngenerating nature-like antibodies with high binding a\u0000ffinity."
            },
            "soundness": {
                "value": 1
            },
            "presentation": {
                "value": 3
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "1. The study employs advanced methods such as DPO/Pareto-DPO to perform alignment for antibody optimization.\n2. The work adopts a three-step approach of pre-training, fine-tuning, and alignment to develop an antibody optimization strategy, achieving state-of-the-art optimization results."
            },
            "weaknesses": {
                "value": "W1. Many recent works on antibody design and optimization are missing in the comparison, including Re\u0000fineGNN [1],\nADesigner [2], GeoAb [3], HTP [4], AbDi\u0000user [5], etc. The lack of discussion and comparison with related work limits the validity of the article to be assessed. Although the article emphasizes antibody optimization through alignment methods based on generative models, it is challenging to integrate these alignment methods with refinement approaches like ABDesigner. However, could these alignment methods be utilized to perform antibody optimization with generative models such as AbDiffuser and GeoAB? Additionally, all new antibody design methods introduced this year should be included for comparison. If the code is not open-sourced, should these methods still be cited? The lack of discussion and comparison with so much related work is a major weakness.\n\nW.2  The article employs Rosetta Energy as an alignment metric, which raises my considerable concerns. My primary issue is that the premise of the paper relies on the assumption that minimizing the Rosetta energy of the complex leads to better antibodies. However, it is well-known that forcefield energies have a weak correlation with measured binding affinity, typically around 0.3 [6,7]. This correlation can be improved to approximately 0.7 by incorporating various additional techniques, such as machine learning classifiers, feature ensembling, and molecular dynamics ensembles. However, these improvements are generally limited to single mutations of a known co-crystal structure.\n\nIn contrast, this study aims to use basic energy formats (with an expected correlation of ~0.3 for single mutations) to guide alignment and optimization across the CDR region. With each additional mutation, one would expect the correlation between energy and real binding affinity to drop exponentially. Thus, it is unclear how the method\u2019s premise of optimizing for binding affinity holds any validity.\n\nAdditionally, force fields naturally favor certain amino acid types at the interface (e.g., hydrophobic residues) because they form strong interactions. However, real antibodies\u2014especially therapeutic ones\u2014are typically not hydrophobic in the CDRs, as hydrophobicity often results in non-specific binding, which is undesirable. This bias toward certain amino acids and interactions can also make antibody sequences less human-like, potentially triggering autoimmune responses. This study does not address or evaluate potential issues caused by force-field guidance, which could be mitigated by incorporating additional metrics, such as TAP scores [8] to ensure that the CDRs are not more hydrophobic or exhibit a worse charge distribution than the baseline model. Alternatively, language models like AntiBERTy could be used to assess whether the generated antibody sequence is plausible (e.g., similar to those in the test set) [9].\n\nW3. Third, I believe a critical issue is the lack of fairness in the comparison experiments. The baseline approaches are generally trained on raw co-crystal structures that are not optimized by Rosetta and do not represent minimal energy states. As a result, it is natural that these models do not produce structures with minimal energies, as they are not fitting a distribution based on minimized energy conformations. In contrast, the proposed method aims to generate minimized structures, leading to results that are not directly comparable with those of the baseline models.\n\nI recommend including models trained on minimized structures in the experimental tables to ensure a fair comparison. Additionally, results from models with post hoc optimization should be included, as this is a standard protocol. This approach would provide readers with a more robust and consistent basis for comparison, ensuring the rigor and accuracy of the experimental results.\n\nW4. Finally, I did not observe a detailed description of the main model architecture in the article, nor the inclusion of commonly used comparison metrics, such as co-design amino acid recovery (AAR), root mean square deviation (RMSD), and the distribution of bond lengths and bond angles. These metrics are crucial because, if a model fails to generate realistic structures and sequences that conform to the distribution of the training samples, it raises a critical question: would such a structure, which deviates significantly from real antibodies, still retain immune functionality? If the generated protein deviates substantially from authentic antibody structures, it is questionable whether merely optimizing for energy is sufficient or even necessary in the context of antibody optimization. A rigorous assessment of the generated structures, in terms of their fidelity to real antibodies, is essential to determine whether they can function as effective immunological agents.\n\n[1] Jin W, Wohlwend J, Barzilay R, et al. Iterative refinement graph neural network for antibody sequence-structure co-design. arXiv preprint arXiv:2110.04624, 2021.\n\n[2] Tan C, Gao Z, Wu L, et al. Cross-gate MLP with protein complex invariant embedding is a one-shot antibody designer. In: Proceedings of the AAAI Conference on Artificial Intelligence. 2024, 38(14): 15222-15230.\n\n[3] Lin H, Wu L, Yufei H, et al. GeoAB: Towards realistic antibody design and reliable affinity maturation. ICML2024.\n\n[4] Wu F, Li S Z. A hierarchical training paradigm for antibody structure-sequence co-design. In: Advances in Neural Information Processing Systems, 2024, 36.\n\n[5] Martinkus K, Ludwiczak J, Liang W C, et al. AbDiffuser: Full-atom generation of in-vitro functioning antibodies. In: Advances in Neural Information Processing Systems, 2024, 36.\n\n[6] Miettinen, M. S., Rajendiran, A., & Muheim, C. Forcefield Energies and Binding Affinity: A Weak Correlation Study. RSC Publishing, 2020.\n \n[7] Ambrosetti, F., Piallini, G., & Zhou, C. Evaluating Forcefield Energies in Protein Binding Studies. National Center for Biotechnology Information, 2020. \n\n[8] Dunbar, J., & Deane, C. M. TAP Scores for Antibody Hydrophobicity and Charge Distribution. Oxford Protein Informatics Group, OPIG. \n\n[9] Akbar, R., & Krawczyk, K. Evaluating Antibody Sequence Probabilities with AntiBERTy. arXiv preprint arXiv:2308.05027, 2023."
            },
            "questions": {
                "value": "All the questions are given in the weakness."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 3
            },
            "confidence": {
                "value": 5
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "AlignAb targets at the conflicting energy preferences, and guides the diffusion model towards Pareto optimality under multiple energy-based alignment objectives. Experimental results show that it achieves high stability and efficiency in producing a better Pareto front of antibody designs compared to baselines."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 3
            },
            "contribution": {
                "value": 3
            },
            "strengths": {
                "value": "(1) The motivation of multi-stage training is convincing, as the 3D complex data are limited compared to sequences. But more related literature should be mentioned in the main text. \n\n(2) The energy-based alignment of diffusion models is novel and interesting. Via an iterative alignment, they can benefit from online exploration. Besides, a decaying temperature scaling is proposed to balance the exploration and exploitation during the sampling process. \n\n(3) The empirical results seem promising, which verifies the effectiveness of AlignAb."
            },
            "weaknesses": {
                "value": "(1) All baselines are not energy-based, namely, they do not count on any energy function such as Rosetta to adjust the output. However, even with Pareto-optimal energy alignment, AlignAb did not achieve the best energy scores across all metrics. Particularly, AlignAb is based on DiffAb, but its CDR-Ag E_att is worse than DiffAb. This phenomenon may weaken the soundness of this proposed algorithm. \n\n(2) No discussion regarding the efficiency of the training. It may be an issue regarding the iteration if the convergence speed is slow and the computation of energy is not fast.  \n\n(3) Code is currently not available."
            },
            "questions": {
                "value": "(1) Have you conducted ablation studies over the three-stage training? I am curious about the benefits of different training phases. Particularly, all baselines are not using the pretrained protein language models (PLM), which may trigger the issue of an unfair comparison. \n\n(2) The multi-stage training is not new. I believe it is necessary to add relevant references like this [i]\nBesides, prior studies have also explored the combination of PLMs and geometric neural networks [ii] [iii]\n\n\n[i] A Hierarchical Training Paradigm for Antibody Structure-sequence Co-design. NeurIPS 2023. \n\n[ii] Enhancing Protein Language Models with Structure-based Encoder and Pre-training. ICLR 2023.\n\n[iii] Integration of pre-trained protein language models into geometric deep learning networks. Communications Biology."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 6
            },
            "confidence": {
                "value": 4
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        }
    ]
}