{
    "id": "FuXtwQs7pj",
    "title": "A diffusion model on toric varieties with application to protein loop modeling",
    "abstract": "The conformation spaces of loop regions in proteins as well as closed kinematic linkages in robotics can be described by systems of polynomial equations, forming Toric varieties. These are real algebraic varieties, formulated as the zero sets of polynomial equations constraining the rotor angles in a linkage or macromolecular chain. These spaces are essentially stitched manifolds and contain singularities. Diffusion models have achieved spectacular success in applications in Cartesian space and smooth manifolds but have not been extended to varieties. Here we develop a diffusion model that performs a random walk on the underlying variety by utilizing an appropriate Jacobian, whose vanishing indicates singularities. This allows our method to explore the variety, without encountering singular or infeasible states. We demonstrated the approach on two important protein structure prediction problems: one is prediction of Major Histocompatibility Complex (MHC) peptide interactions, a critical part in the design of  neoantigen vaccines, and the other is loop prediction for nanobodies, an important class of drugs. In both, we improve upon the state of the art open source AlphaFold.",
    "keywords": [
        "Protein loop",
        "Toric varieties",
        "Jacobian",
        "Tangent space",
        "MHC",
        "Nanobody"
    ],
    "primary_area": "applications to physical sciences (physics, chemistry, biology, etc.)",
    "TLDR": "",
    "creation_date": "2024-09-28",
    "original_date": "2024-10-04",
    "modification_date": "2024-10-13",
    "forum_link": "https://openreview.net/forum?id=FuXtwQs7pj",
    "pdf_link": "https://openreview.net/pdf?id=FuXtwQs7pj",
    "comments": [
        {
            "summary": {
                "value": "The paper focuses on the problem that the loop regions usually have lower accuracy compared to other structures in the protein prediction tasks. The paper proposes a diffusion model to generate loop conformations in toric varierty space. The performance of the method was tested using the MHC dataset and the nanobody dataset. It achieves improvement upon AlphaFold 2 by 15% and comparable performance to AlphaFold 3."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 2
            },
            "contribution": {
                "value": 3
            },
            "strengths": {
                "value": "- The paper focuses on the loop regions in the protein, which is a useful topic to improve the protein prediction results.\n- The paper proposes a novel diffusion process on toric varieties to generate conformations for protein loop regions with constrained ends."
            },
            "weaknesses": {
                "value": "- Although the paper selects \"No Acknowledgement Section\", there is an acknowledgement section in the paper...\n- Besides, I just have some additional questions listed in the \"question\" section."
            },
            "questions": {
                "value": "- How long does it take to run each inference step?\n- Does the diffusion model also takes non-loop regions as input information?\n- In Figure 2, the paper compares results with AF2(1) and AF2(20) and AF3. Was there a specific reason to not compare with AF3 in the similar way as AF2 (i.e., also compare the best results of 20 random seeds)?\n- The method first uses AF2 to predict the protein structures and uses that as inputs. The diffusion model then improve the protein prediction results by generated conformations for the loop regions. It achieve improvement upon AlphaFold 2 by more than 15% and comparable performance to AlphaFold 3.  - If the input protein structures are generated by other methods (such as AF3) instead, will the proposed method also give the similar amount of improvement upon the initial structures?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 5
            },
            "confidence": {
                "value": 2
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper proposes a diffusion model on the conformation space of loop regions in proteins, using tools from inverse kinematics in robotics. In particular, for a given protein loop region, they solve for the basis vectors of the manifold of torsion angles which maintain the position of the loop ends, using singular value decomposition. They then add noise to the given torsion angle along this manifold, ensuring loop closure with the R6B6 algorithm. They then seem to learn the score function w.r.t. this diffusion process. Experimental results indicate improved performance compared to AlphaFold 2 and 3. Overall the paper was reasonably well-written and proposes an interesting approach. However, I am unsure about the significance and motivation of the approach. Additionally, I felt that more elaboration is needed on some aspects, e.g. the score-matching algorithm and the method R6B6."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 2
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "1. Presents a novel approach, to the best of my knowledge.\n2. Make an interesting connection between molecules and robotics.\n3. Takes advantage of AlphaFolds predictions as inputs, making much more data available."
            },
            "weaknesses": {
                "value": "1. Can be cumbersome to do an SVD of the Jacobian matrix at every step.\n2. Not much elaboration on the score-matching part of the algorithm.\n3. Uses an external method, R6B6, to ensure loop closures, but does not elaborate much on it."
            },
            "questions": {
                "value": "1. What is the cost of computing the SVD of the Jacobian at every step compared to classical geometric methods?\n2. How much does the change in loop conformation affect the conformation of the rest of the protein?\n3. Could you please elaborate more on the use of R6B6"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed.",
                    "Yes, Other reasons (please specify below)"
                ]
            },
            "details_of_ethics_concerns": {
                "value": "The authors seemed to forget to remove the acknowledgments (although I did not notice until the end of the review)."
            },
            "rating": {
                "value": 5
            },
            "confidence": {
                "value": 3
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "The paper introduces a diffusion model that allows to explore toric algebraic varieties. The authors demonstrate an improvement upon the state-of-the-art AlphaFold approach on two protein structure prediction data sets."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 1
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "The structure of the paper is good, and the choice of experiments (data sets, baseline method) seem to be appropriate."
            },
            "weaknesses": {
                "value": "The paper is extremely difficult to read, I think it is inaccessible to the majority of the wide ICLR audience. This is the main reason behind my rejection, I am willing to raise my score if the main goal and contributions of the paper are much more clearly described.\n\nFor instance, after reading the Abstract and Introduction, it was still not clear to me what the problem is one is aiming to solve. Formulations such as \"molecular modeling\", \"molecular structure generation\" and \"protein prediction\" are used, but the abstract also mentions kinematic linkages in robotics, so what is the (precise) formulation of the general problem? In addition, so much jargon is used, such as \"conformer sampling\" (already in the very first paragraph, without any further context or explanation), \"number of flexible torsions in the loop\", \"energetics\", \"rotors\", ... Related work is using too much jargon too, and is almost unreadable for general audience. \n\nSee Questions below for more examples, that could help to make the paper clearer and of interest to a wider community. For these reasons, it was impossible for me to properly assess the quality of this manuscript."
            },
            "questions": {
                "value": "(Q1) What is precisely the problem you are aiming to solve? As I mention above, you use \"molecular modeling\", \"molecular structure generation\" and \"protein prediction\", but at a later point in the Introduction you also talk about learning a constrained high dimensional manifold. If the latter also applies, should the Related work not also discuss the manifold learning literature?\n\n(Q2) What is the (idea behind) diffusion model and why is it useful for this problem? In Introduction, you explain this with \"Since conformer sampling can be treated as a generative problem, many diffusion models have been proposed to produce molecular conformers ...\", but this is not very useful if one does not yet understand the problem (Q1), nor is familiar with conformers.\n\n(Q3) The result from Angeles (2014) that guarantees that six of the torsions can be determined once other n-6 torsions are assigned is only mentioned as such in the Introduction, but then heavily used throughout the paper. Can you at least provide some intuition behind this results, where is the number 6 coming from? Also, since this is a book of almost 600 pages, it would be useful to point to a specific result (theorem or at least a section).\n\n(Q4) At the end of the Related work section, you mention that AF can be run several times starting from different random seeds. Until this moment, the reader does not even know that the method is not deterministic. Since you use this approach as the baseline you compare against, can you describe it briefly, how does it work? Which group of methods does it belong to, from the ones you mention early in this section? What are the crucial differences between AF and your proposed approach?\n\n(Q5) The score model is using a similar architecture based on e3nn and tensor field network that have not been peer reviewed and have respectively around 150 and 1000 citations, why not PointNet that has over 15000 citations and is commonly used as a benchmark deep learning architecture for point clouds?\n\n(Q6) What is \u00c5?\n\n(Q7) Why is AF3 used in Section 4.1, but not also in Section 4.2?\n\n(Q8) In the Conclusion (and all of a sudden), you write that \"Previous studies on protein structure prediction have maintained that relationships between residues at long distances cannot be learned using a diffusion model.\" What is this based on, what is the underlying logic and why did you decide for a diffusion model despite these insights?\n\nTypos and minor comments:\n- line 088: conformerss\n- line 089: varierty\n- line 298: Appendix Table 3 -> Appendix A Table 1\n- References: The references should be properly formatted in the main text (so that they appear in brackets whenever appropriate, choose carefully between \\citet and \\citep). Also, in the References section, improve the formatting, e.g., capitalization of journals (Advances in neural information processing systems)."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "The Acknowledgment section explicitly mentions some NIH and NSF grants, centres and facilities, not sure if this violates the submission guidelines / anonymity policy."
            },
            "rating": {
                "value": 3
            },
            "confidence": {
                "value": 2
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "The paper describes heuristic studies of random walks on spaces of chained atoms."
            },
            "soundness": {
                "value": 1
            },
            "presentation": {
                "value": 2
            },
            "contribution": {
                "value": 1
            },
            "strengths": {
                "value": "Two algorithms are given with pseudocodes."
            },
            "weaknesses": {
                "value": "Though the paper studies protein chains, they are called \"molecules\". In structural biology, a protein molecule can be a collection of many chains, which is called a bilogical assembly or a protein complex, while all smaller molecules (interacting with proteins) are called ligands.\n\nLine 118: \"we assume the internal conformation of side chains to be fixed\"\n\nThis assumption seems too strict because side chains provide hydrogen bonds that form the most important secondary structures.\n\nLine 120: \"the space of internal protein chain conformations is the hypertorus.\"\n\nSome values of torsion angles lead to clashed atoms involving side chains, hence a realizable space of torsion angles is smaller, see https://www.pnas.org/doi/abs/10.1073/pnas.1014674107\n\nLines 126-127: \"Unlike diffusion on Euclidean spaces or smooth manifolds,\ndiffusion on varieties can be challenging in the vicinity of singularities.\"\n\nThough singularities are explicitly mentioned here, Figure 1 and all further constructions discuss smooth manifolds. The word \"variety\" appears only two more times in the abstract. \n\nLine 131: \"a loop region can move in a finite number of directions to keep the ends fixed\"\n\nBecause atom coordinates are continuous, they can move in infinitely many directions. \n\nLines 215: \"The score model is using a similar architecture based on SE(3)-equivariant convolutional networks over point clouds\"\n\nIf points are not ordered in these clouds, this case is not relevant for protein chains whose atoms are naturally ordered along the backbone. The ordered case is much easier than unordered because a complete SE(3)-invariant has a linear size."
            },
            "questions": {
                "value": "The major weakness is the lack of a rigorous problem statement. \n\nLine 17: \"we develop a diffusion model that performs a random walk\"\n\nWhat the purpose of this \"random walk\"?\n\nThe key concept of a \"loop\", which appears 80+ times in the paper including the title is never formally defined. Did the authors mean a geometric embedding of several consecutive amino acid residues or only some atoms (which?) along the backbone without side chains, which are not marked as alpha-helices or beta-strands?\n\nLines 114-115: \"the observed variations of bond lengths and angles in experiments are relatively small\"\n\nHow can this claim be justified? For protein chains, bond lengths and angles are not \"observed\" but are often fixed or refined to \"ideal\" values. Despite this artificial fixing, the Protein Data Bank has a large percentage of chains whose bond lengths and angles are outside many standard deviations from \"ideal\" values. \n\nLines 176-177: \"(the Implicit Function Theorem) guarantees that six of the variables may be expressed as differentiable functions\"\n\nThis theorem holds only under strict conditions. Why are they satisfied?\n\nLines 198-202: \"We apply R6B6 Cao et al. (2023) algorithm, which is designed to solve closure problem in the chain with fixed ends ... if the closure problem is not solvable by R6B6 which indicating an infeasible movement, the next perturbation will be tried until one solvable case is sampled successfully.\"\n\nCan these tries in a continuous space continue infinitely long?\n\nLines 285-287: \"in the diffusion on toric verieties, the basis vectors for the tangent space at one point on the manifold are dependent on the position of the point, so we need to compute the basis vectors at every step\"\n\nThere is no need to consider any tangent spaces of high-dimensional tori because these manifolds are flat (locally Euclidean in terms of distances and angles), see https://en.wikipedia.org/wiki/Flat_manifold. For a simple example, a 2D torus has two angle coordinates in ranges [0,2pi). Why do you need to embed this torus in 3D?\n\nLine 301: \"Each structure was split into two parts: the loop region and the remaining part of the protein.\"\n\nWhile a loop region wasn't formally defined, a protein structure likely contains many loop regions. Which one is chosen here?\n\nLine 308: \"we used the same AF2 model to obtain predicted Local Distance Difference Test (pLDDT) values Mariani et al. (2013)\" \n\nDo you agree with the conclusion of Mariani et al. (2013) on page 2728: ``One disadvantage of the LDDT score is that it does not fulfill the mathematical criteria to be a metric\"?\n\nIf yes, do you know that if a distance fails the triangle axiom with any positive error, then results of clustering can be pre-determined and hence not trustworthy as proved in https://ieeexplore.ieee.org/abstract/document/10574843? \n\nLine 310: \"We then used these values to rank the structures and determine the confidence of the predictions.\"\n\nHow are these predictions justified in the light of the references above?\n\nLine 320-321: \"The testing results showed that closer conformations to the PDB structures exist within the ensemble, demonstrating that the model functions correctly.\"\n\nThe loop regions have huge uncertainty in PDB structures because the structure determination methods usually have low resolutions in these regions. Is it possible justify that the \"model functions correctly\" by using unreliable \"ground truth\"?\n\nHow large are the databases discussed in sections 4.1 and 4.2?\n\nLines 13-14: \"Toric varieties. These are real algebraic varieties, formulated as the zero sets of polynomial equations constraining the rotor angles in a linkage or macromolecular chain.\"\n\nThe abstract promised to describe toric varieties of macromolecular chains by polynomial equations. In what line numbers did these equations appear if the word \"polynomial\" was found twice in the abstract and never again?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "Yes, Other reasons (please specify below)"
                ]
            },
            "details_of_ethics_concerns": {
                "value": "The paper included the acknowledgments that de-anonymized the submission:\n\n\"This work was partly supported by NIH Grant RM1 GM135136, and by NSF Grant DMS 2054251. We gratefully acknowledge support from Laufer Center for Physical and Quantitative Biology. This research used resources of the Oak Ridge Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC05-00OR22725.\""
            },
            "rating": {
                "value": 1
            },
            "confidence": {
                "value": 4
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        }
    ]
}