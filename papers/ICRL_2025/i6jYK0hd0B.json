{
    "id": "i6jYK0hd0B",
    "title": "3D Interaction Geometric Pre-training for Molecular Relational Learning",
    "abstract": "Molecular Relational Learning (MRL) is a rapidly growing field that focuses on understanding the interaction dynamics between molecules, which is crucial for applications ranging from catalyst engineering to drug discovery. \nDespite recent progress, earlier MRL approaches are limited to using only the 2D topological structure of molecules, as obtaining the 3D interaction geometry remains prohibitively expensive.\nThis paper introduces a novel 3D geometric pre-training strategy for MRL (3DMRL) that incorporates a 3D virtual interaction environment, overcoming the limitations of costly traditional quantum mechanical calculation methods. \nWith the constructed 3D virtual interaction environment, 3DMRL trains 2D MRL model to learn the overall 3D geometric information of molecular interaction through contrastive learning.\nMoreover, fine-grained interaction between molecules is learned through force prediction loss, which is crucial in understanding the wide range of molecular interaction processes.\nExtensive experiments on various tasks using real-world datasets, including out-of-distribution and extrapolation scenarios, demonstrate the effectiveness of 3DMRL, showing up to a 24.93 % improvement in performance across 40 tasks.\nOur code is publicly available at https://anonymous.4open.science/r/3DMRL-F973.",
    "keywords": [
        "Molecular Relational Learning",
        "AI4Science",
        "Geometric Deep Learning"
    ],
    "primary_area": "learning on graphs and other geometries & topologies",
    "TLDR": "",
    "creation_date": "2024-09-26",
    "original_date": "2024-10-04",
    "modification_date": "2024-10-13",
    "forum_link": "https://openreview.net/forum?id=i6jYK0hd0B",
    "pdf_link": "https://openreview.net/pdf?id=i6jYK0hd0B",
    "comments": [
        {
            "summary": {
                "value": "The paper presents a novel 3D interaction geometry pre-trained method for molecule relational learning, where fine-grained molecule interaction is learned through force prediction loss. Experiments on six popular datasets demonstrate the effectiveness of the proposed method based on molecule relational learning."
            },
            "soundness": {
                "value": 2
            },
            "presentation": {
                "value": 3
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "1. The introduction of 3D information pre-training in molecule relational learning is innovative.\n2. The model obtains excellent results on a variety of datasets showing its generality."
            },
            "weaknesses": {
                "value": "1. The major concern is that intermolecular interactions and chemical bonds are distinct, and Local frame is suitable only for single molecule modeling. On the other hand, the 3D GNN framework, which considers cutoff distances, may truncate long-range forces and does not differentiate between intermolecular forces and chemical bonds in modeling molecular pairs.\n2. In contrastive pre-training, Line 247-248, aligning multiple 3D solvent representations to the same 2D representation introduces ambiguity, making it challenging for the model to learn a consistent mapping. This bias can result in feature alignment that deviates from true chemical and physical properties.\n3. Acquiring 3D structures is costly, and those generated by common force fields algorithms may be unsuitable for solvated molecular."
            },
            "questions": {
                "value": "1. How is the initial position obtained? \n2. Some datasets do not contain energy labels, such as the Chromophore dataset and DDI dataset, how to obtain the force and ground true force label?\n3. What is the ratio of large molecules to small molecules? Does the ratio of different molecules have an effect on the results?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 5
            },
            "confidence": {
                "value": 5
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper introduces 3DMRL, a molecular pre-training framework that leverages 3D interaction geometries to enhance 2D models for molecular representation learning (MRL). To efficiently obtain large-scale 3D interaction data, this paper proposes a strategy that constructs virtual interaction geometries by positioning small molecules around a central larger molecule. Using this dataset, a 2D-3D contrastive learning task and an intermolecular force prediction task is combined for pre-training. The results demonstrate the superiority and generalizability of the proposed method."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 3
            },
            "contribution": {
                "value": 2
            },
            "strengths": {
                "value": "1. This paper innovatively introduces an interaction-based perspective for MRL pre-training.\n2. The virtual interaction dataset construction is efficient and presents a clear methodology, making it easily reproducible."
            },
            "weaknesses": {
                "value": "1. Compared to prior methods like GraphMVP and 3D Infomax, which also leverage contrastive tasks between 2D and 3D graphs, this paper\u2019s 'only cont.' variant outperforms the contrastive baselines, as shown in Tables 2, 3, and Figure 3(a). Could the authors elaborate on the primary distinctions between this variant and existing methods?\n2. For the force prediction task, directly using the vector direction from each atom in the small molecule to the corresponding atom in the larger molecule lacks clear theoretical or motivational support. Moreover, as indicated by Figure 3, this task contributes only a marginal performance gain.\n3. Certain notations are unclear. For instance, in Line 307, it is puzzling why the output of the 'Projection' function is in $\\mathbb{R}^d$ instead of $\\mathbb{R}^3$."
            },
            "questions": {
                "value": "See the weaknesses above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 3
            },
            "confidence": {
                "value": 4
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper proposes a method for constructing a 3D virtual interaction environment, integrating it with a 2D representation through a contrastive learning paradigm to enable the 2D model to learn 3D geometric information of molecular interactions. Additionally, inter-molecular forces are used as a prediction target, supporting a deeper understanding of various molecular interaction processes. These two strategies significantly enhance the performance of the 2D model."
            },
            "soundness": {
                "value": 3
            },
            "presentation": {
                "value": 3
            },
            "contribution": {
                "value": 3
            },
            "strengths": {
                "value": "1. The proposed virtual interaction environment is a novel approach.\n2. Experimental results demonstrate that 3DMRL effectively improves performance across various 2D MRL models.\n3. The writing is clear and well-structured."
            },
            "weaknesses": {
                "value": "The authors claim that the proposed virtual interaction geometry appropriately reflects the real-world physics of molecular interactions. However, I find that the current implementation conflicts with established chemical knowledge in several ways:\n\n1. Number of Interacting Molecules: The number of small molecules in the interaction environment should be variable, depending on the specific molecular properties of $g_{3D}^1$ and $g_{3D}^2$. However, the authors use a fixed $n = 5$, which assumes that all large molecules $g_{3D}^1$ interact with exactly five $g_{3D}^2$ molecules. This approach lacks scientific basis.\n\n2. Heuristic Construction of Virtual Interaction Geometry: The method for constructing the virtual interaction geometry is entirely heuristic. It involves randomly selecting $n$ atoms from the non-aromatic ring of $g_{3D}^1$ and positioning $n$ smaller molecules $g_{3D}^2$ near these atoms by translating and rotating the original 3D coordinates $R^2$ of the smaller molecule. However, interactions between two molecules are complex, and assuming that interactions only occur in non-aromatic regions is inaccurate. While aromatic rings are generally stable, they can still participate in interactions, and randomly selected atoms from the non-aromatic ring may not necessarily engage in molecular interactions. Furthermore, the description in \u201cStep 2: Positioning the Smaller Molecules\u201d seems to lack chemical justification.\n\n3. Pseudo Force Definition: Since actual molecular forces $f_k^i$ are not available, the authors propose using the direction between the $k$-th atom of the $i$-th small molecule and the $i$-th atom of the larger molecule to which the small molecule is attached as a pseudo force, defined as $f_k^i = R_i^1 / ||R_k^{2,i} - R_i^1||$. However, molecular interactions can involve multiple forces, such as hydrogen bonds, van der Waals forces, and ion-dipole interactions, each varying significantly in magnitude. Consequently, it is questionable whether $f_k^i = R_i^1 / ||R_k^{2,i} - R_i^1||$ can accurately represent real interaction forces.\n\nThe core concern is that if the proposed virtual interaction geometry and pseudo force do not align with chemical principles, it raises doubts about the effectiveness of the proposed method."
            },
            "questions": {
                "value": "1. Virtual Interaction Geometry as Data Augmentation: As noted in the \"weakness\" section, I believe the virtual interaction geometry largely lacks chemical validity. I am inclined to view the virtual interaction geometry as a form of data augmentation, where $g_{3D}^1$ and $g_{3D}^2$ are combined to create diverse configurations. Given that there are $n$ instances of $g_{3D}^2$, and their positions vary in each epoch, this can be seen as augmenting the data for $g_{3D}^1$ and $g_{3D}^2$. Following this view, an alternative approach could involve combining $g_{3D}^1$ and $g_{3D}^2$ while randomly perturbing atom coordinates, adding or removing atoms, or even creating combinations entirely at random instead of using the author\u2019s proposed Step 2. If these variations are also effective, then it may be reasonable to interpret the virtual interaction geometry as data augmentation (rather than as a chemically meaningful virtual environment as the authors claim). Conversely, if these augmentations differ in key ways from the proposed method, it would be helpful to clarify the specific factors that make the proposed method effective.\n\n2. Choice of $\\mathbf{z}{2d}$ over $\\mathbf{z}{3d}$ in Experiments: In the experimental section, the authors appear to have used only $\\mathbf{z}{2d}$ for the experiments. Why was $\\mathbf{z}{3d}$ not selected? Since $\\mathbf{z}{2d}$ learns 3D information through contrastive learning with $\\mathbf{z}{3d}$, $\\mathbf{z}{3d}$ should, in theory, also acquire topological information from $\\mathbf{z}{2d}$. It would be interesting to see whether $\\mathbf{z}{3d}$ obtained via contrastive learning improves performance compared to the direct application of $R{vr}$ to the 3D encoder to derive $\\mathbf{z}_{3d}$.\n\n3. Pre-training Baselines in Table 2: In Table 2, the authors compare the performance of the CIGIN model on molecular interaction tasks using different pre-training strategies, with 3D Infomax, GraphMVP, and MoleculeSDE chosen as baselines. These models integrate 2D graph and 3D information in their training. I believe it would be beneficial to include purely 3D-based methods, such as Uni-mol, as additional baselines."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 5
            },
            "confidence": {
                "value": 4
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        {
            "summary": {
                "value": "This paper designs a pre-training framework for Molecular Relational Learning. Including two self-supervised tasks including interaction geometry contrastive learning and intermolecular force prediction."
            },
            "soundness": {
                "value": 2
            },
            "presentation": {
                "value": 2
            },
            "contribution": {
                "value": 1
            },
            "strengths": {
                "value": "1. The paper is well-written and easy to understand.\n2. The downstream tasks are diverse, and the performance improvements are substantial."
            },
            "weaknesses": {
                "value": "1. The molecular interaction environments are complex; simply moving two different molecular positions together with some random noise to simulate such a complex environment is far from realistic.\n2. The intermolecular force prediction tasks based on this virtual environment are somewhat artificial. The pseudo force labels derived from the relative positions of two atoms are nonsensical.\n3. What is the rationale behind the task of interaction geometry contrastive learning, and what type of interaction information does this task aim to learn?\n4. How are the molecular pairs selected from the dataset, what kind of relation between these two molecules? The paper should provide more details regarding the validity of the simulation."
            },
            "questions": {
                "value": "See weakness"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": 3
            },
            "confidence": {
                "value": 5
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        }
    ]
}